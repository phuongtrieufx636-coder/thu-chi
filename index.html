<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>S·ªï Thu Chi - Web App (Nh·∫≠p & B√°o c√°o)</title>
<style>
  :root{
    --bg:#ffffff; --fg:#0f172a; --muted:#64748b;
    --accent:#f59e0b; --accent2:#2563eb;
    --green:#16a34a; --red:#dc2626;
    --card:#f8fafc; --border:#e2e8f0;
  }
  *{box-sizing:border-box}
  body{margin:0;background:var(--bg);color:var(--fg);font:14px/1.45 system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial}
  header{position:sticky;top:0;background:#fff;border-bottom:1px solid var(--border);z-index:5}
  .wrap{max-width:1100px;margin:0 auto;padding:14px}
  h1{font-size:18px;margin:0 0 10px}
  .toolbar{display:flex;flex-wrap:wrap;gap:8px;align-items:center}
  .toolbar .group{display:flex;gap:8px;align-items:center;flex-wrap:wrap}
  input,select,button,textarea{border:1px solid var(--border);border-radius:10px;padding:10px 12px;background:#fff;color:var(--fg)}
  button.primary{background:var(--accent);color:#111;border-color:var(--accent);font-weight:700}
  button.ghost{background:#fff}
  .quick button{border-radius:20px;padding:6px 10px}
  .cards{display:grid;grid-template-columns:repeat(3,1fr);gap:12px;margin:12px 0}
  .card{background:var(--card);border:1px solid var(--border);border-radius:12px;padding:14px}
  .card h3{margin:0 0 6px;font-size:12px;color:var(--muted);font-weight:600;text-transform:uppercase;letter-spacing:.06em}
  .value{font-size:20px;font-weight:700}
  .value.green{color:var(--green)}
  .value.red{color:var(--red)}
  table{width:100%;border-collapse:collapse;background:#fff;border:1px solid var(--border);border-radius:12px;overflow:hidden}
  thead th{position:sticky;top:56px;background:#fafafa;border-bottom:1px solid var(--border);padding:10px;text-align:left;font-size:12px;color:var(--muted)}
  tbody td{border-bottom:1px solid var(--border);padding:10px;vertical-align:top}
  tbody tr:hover td{background:#f9fafb}
  .type-pill{display:inline-block;padding:2px 8px;border-radius:999px;font-size:12px;border:1px solid var(--border)}
  .type-income{background:#ecfdf5;color:#065f46;border-color:#a7f3d0}
  .type-expense{background:#fef2f2;color:#7f1d1d;border-color:#fecaca}
  .table-wrap{overflow:auto;border-radius:12px}
  footer{padding:24px;color:var(--muted)}
  .mobile .cards{grid-template-columns:1fr}
  .mobile thead th{top:98px}
  .hint{color:var(--muted);font-size:12px}

  .entry{position:sticky;bottom:0;background:#fff;border-top:1px solid var(--border)}
  .tabs{display:flex;gap:8px;margin-bottom:12px}
  .tab{flex:0 0 auto;padding:10px 14px;border-radius:999px;border:1px solid var(--border);cursor:pointer;font-weight:600}
  .tab.active{background:#fff7ed;border-color:#fed7aa;color:#b45309}
  .tab.income.active{background:#ecfdf5;border-color:#bbf7d0;color:#166534}
  .field{display:flex;align-items:center;gap:10px;margin:8px 0}
  .field label{min-width:70px;color:#475569}
  .amount{font-size:16px;font-weight:700}
  .grid{display:grid;grid-template-columns:repeat(3,1fr);gap:10px}
  .cat{display:flex;align-items:center;gap:8px;border:1px solid var(--border);border-radius:12px;padding:10px;background:#fff;cursor:pointer}
  .cat.active{outline:2px solid #ffd28a;background:#fffaf0}
  .cat .ico{font-size:20px;width:22px;text-align:center}
  .bigButton{display:block;width:100%;padding:16px 18px;border-radius:999px;border:none;background:var(--accent);color:#111;font-weight:800;font-size:16px;cursor:pointer;margin:14px 0}
  .subnav{display:flex;justify-content:space-around;padding:8px 0;border-top:1px solid var(--border);color:#64748b}
  .subnav .item{display:flex;flex-direction:column;align-items:center;font-size:12px;gap:4px;padding:6px 8px}
  .danger{color:var(--red);cursor:pointer}
  .row-actions{display:flex;gap:8px}
  .sep{width:1px;height:24px;background:var(--border)}
</style>
</head>
<body>
<header>
  <div class="wrap">
    <h1>S·ªï Thu Chi (Offline) ‚Äî TTM</h1>
    <div class="toolbar">
      <div class="group">
        <label>T·ª´ ng√†y <input type="date" id="fromDate"></label>
        <label>ƒê·∫øn ng√†y <input type="date" id="toDate"></label>
      </div>
      <div class="group quick">
        <button class="ghost" data-q="today">H√¥m nay</button>
        <button class="ghost" data-q="week">Tu·∫ßn n√†y</button>
        <button class="ghost" data-q="month">Th√°ng n√†y</button>
        <button class="ghost" data-q="year">NƒÉm nay</button>
        <button class="ghost" data-q="all">T·∫•t c·∫£</button>
      </div>
      <div class="group">
        <select id="typeSel">
          <option value="">Lo·∫°i: T·∫•t c·∫£</option>
          <option value="Income">Thu</option>
          <option value="Expense">Chi</option>
        </select>
        <select id="catSel">
          <option value="">Danh m·ª•c: T·∫•t c·∫£</option>
        </select>
        <input id="search" placeholder="T√¨m ghi ch√∫ / danh m·ª•c..." />
      </div>
      <div class="group">
        <button id="btnImport" class="ghost">Nh·∫≠p CSV</button>
        <div class="sep"></div>
        <button id="btnExport" class="primary">Xu·∫•t CSV (l·ªçc hi·ªán t·∫°i)</button>
        <input id="fileCSV" type="file" accept=".csv,text/csv" style="display:none" />
      </div>
    </div>
    <div class="cards">
      <div class="card">
        <h3>T·ªïng Thu</h3>
        <div id="sumIncome" class="value green">0</div>
      </div>
      <div class="card">
        <h3>T·ªïng Chi</h3>
        <div id="sumExpense" class="value red">0</div>
      </div>
      <div class="card">
        <h3>Ch√™nh l·ªách</h3>
        <div id="sumNet" class="value">0</div>
      </div>
    </div>
  </div>
</header>

<main class="wrap">
  <div class="table-wrap">
    <table id="tbl">
      <thead>
        <tr>
          <th>Ng√†y</th>
          <th>Lo·∫°i</th>
          <th>Danh m·ª•c</th>
          <th>Ghi ch√∫</th>
          <th style="text-align:right">S·ªë ti·ªÅn (ƒë)</th>
          <th>Thao t√°c</th>
        </tr>
      </thead>
      <tbody></tbody>
    </table>
  </div>
</main>

<section class="entry">
  <div class="wrap">
    <div class="tabs">
      <div id="tabExpense" class="tab active">Ti·ªÅn chi</div>
      <div id="tabIncome" class="tab income">Ti·ªÅn thu</div>
    </div>

    <div class="field">
      <label>Ng√†y</label>
      <input id="inDate" type="date" />
    </div>
    <div class="field">
      <label>Ghi ch√∫</label>
      <input id="inMemo" type="text" placeholder="Ch∆∞a nh·∫≠p v√†o" />
    </div>
    <div class="field">
      <label id="amountLabel">Ti·ªÅn chi</label>
      <input id="inAmount" class="amount" type="number" step="1" min="0" inputmode="numeric" placeholder="0" />
      <div>ƒë</div>
    </div>

    <div class="field"><label>Danh m·ª•c</label></div>
    <div id="catGrid" class="grid"></div>

    <button id="btnAdd" class="bigButton">Nh·∫≠p kho·∫£n chi</button>
  </div>
  <div class="subnav">
    <div class="item">üìù <span>Nh·∫≠p v√†o</span></div>
    <div class="item">üìÖ <span>L·ªãch</span></div>
    <div class="item">üìä <span>B√°o c√°o</span></div>
    <div class="item">‚ãØ <span>Kh√°c</span></div>
  </div>
</section>

<footer class="wrap">
  <div class="hint">CSV g·ªëc + CSV nh·∫≠p th√™m ƒë·ªÅu x·ª≠ l√Ω c·ª•c b·ªô; kho·∫£n m·ªõi nh·∫≠p tay l∆∞u ·ªü localStorage.</div>
</footer>

<script id="csvData" type="text/plain">inputDate, amount(dong), memo, type, categoryId, categoryName, categoryIcon, categoryColor, categoryIndex, fixedCostSettingId, fixedCostSettingStartDate, fixedCostSettingEndDate, fixedCostSettingFrequency, fixedCostSettingLastInsertedToDailyData, dayOffOption
2025/4/28,0,,Expense,-1,Kh√¥ng c√≥,categoryNashi,505050,-1,,,,,,
2025/4/28,0,,Income,12,Ti·ªÅn l∆∞∆°ng,categoryDefault11,4eb46a,13,,,,,,
2025/6/2,500000,√âp capfold 3,Income,19,Ti·ªÅn l√†m,category1,ffe666,12,,,,,,
2025/6/2,15000,Ch·ª£ mua ƒë·ªì ,Expense,2,Chi ti√™u h√†ng ng√†y,categoryDefault1,00b547,2,,,,,,
2025/6/2,700000,Fix 13prm (ƒê√¥ng),Income,19,Ti·ªÅn l√†m,category1,ffe666,12,,,,,,
2025/6/4,1500000,,Income,19,Ti·ªÅn l√†m,category1,ffe666,12,,,,,,
2025/6/4,200000,,Expense,2,Chi ti√™u h√†ng ng√†y,categoryDefault1,00b547,2,,,,,,
2025/6/5,1500000,Ti·ªÅn √∫t,Expense,2,Chi ti√™u h√†ng ng√†y,categoryDefault1,00b547,2,,,,,,
2025/6/5,500000,Fix 13pro,Income,19,Ti·ªÅn l√†m,category1,ffe666,12,,,,,,
2025/6/5,180000,K√≠nh 8p,Income,19,Ti·ªÅn l√†m,category1,ffe666,12,,,,,,
2025/6/5,50000,C∆°m cf,Expense,1,ƒÇn u·ªëng,categoryDefault0,ff8700,1,,,,,,
2025/6/8,500000,C·∫£m 11prm,Income,19,Ti·ªÅn l√†m,category1,ffe666,12,,,,,,
2025/6/9,500000,13prm ,Income,19,Ti·ªÅn l√†m,category1,ffe666,12,,,,,,
2025/6/9,450000,K√≠nh 11prm,Income,19,Ti·ªÅn l√†m,category1,ffe666,12,,,,,,
2025/6/9,200000,Chi ti√™u,Expense,2,Chi ti√™u h√†ng ng√†y,categoryDefault1,00b547,2,,,,,,
2025/6/10,50000,Chi tieu,Expense,2,Chi ti√™u h√†ng ng√†y,categoryDefault1,00b547,2,,,,,,
2025/6/10,150000,C·∫£m xsm,Expense,20,Linh ki·ªán,category1,ffe666,3,,,,,,
2025/6/10,1100000,Thay m√†n 11prm,Income,19,Ti·ªÅn l√†m,category1,ffe666,12,,,,,,
2025/6/11,50000,ƒÇn s√°ng cf,Expense,1,ƒÇn u·ªëng,categoryDefault0,ff8700,1,,,,,,
2025/6/11,25000,C∆°m tr∆∞a,Expense,1,ƒÇn u·ªëng,categoryDefault0,ff8700,1,,,,,,
2025/6/11,50000,XƒÉng,Expense,2,Chi ti√™u h√†ng ng√†y,categoryDefault1,00b547,2,,,,,,
2025/6/11,370000,C·∫£m xsm,Expense,20,Linh ki·ªán,category1,ffe666,3,,,,,,
2025/6/11,450000,K√≠nh 12pro,Income,19,Ti·ªÅn l√†m,category1,ffe666,12,,,,,,
2025/6/11,500000,C·∫£m xsm ,Income,19,Ti·ªÅn l√†m,category1,ffe666,12,,,,,,
2025/6/13,220000,Xsm c·∫£m ,Expense,20,Linh ki·ªán,category1,ffe666,3,,,,,,
2025/6/13,200000,M√†n 7p ,Expense,20,Linh ki·ªán,category1,ffe666,3,,,,,,
2025/6/13,30000,K√≠nh 8p ,Expense,20,Linh ki·ªán,category1,ffe666,3,,,,,,
2025/6/13,50000,530,Expense,20,Linh ki·ªán,category1,ffe666,3,,,,,,
2025/6/13,500000,C·∫£m xsm ,Income,19,Ti·ªÅn l√†m,category1,ffe666,12,,,,,,
2025/6/13,180000,K√≠nh 8p,Income,19,Ti·ªÅn l√†m,category1,ffe666,12,,,,,,
2025/6/14,200000,L∆∞ng 14prm ,Expense,20,Linh ki·ªán,category1,ffe666,3,,,,,,
2025/6/14,220000,C·∫£m xsm,Expense,20,Linh ki·ªán,category1,ffe666,3,,,,,,
2025/6/14,500000,L∆∞ng 14prm,Income,19,Ti·ªÅn l√†m,category1,ffe666,12,,,,,,
2025/6/14,750000,7p thay m√†n l∆∞ng,Income,19,Ti·ªÅn l√†m,category1,ffe666,12,,,,,,
2025/6/16,500000,Pin 12pro vy h√†ng x√≥m,Income,19,Ti·ªÅn l√†m,category1,ffe666,12,,,,,,
2025/6/16,600000,13prm,Income,19,Ti·ªÅn l√†m,category1,ffe666,12,,,,,,
2025/6/17,100000,ƒÇn s√°ng ,Expense,1,ƒÇn u·ªëng,categoryDefault0,ff8700,1,,,,,,
2025/6/17,100000,Ch·ª£,Expense,2,Chi ti√™u h√†ng ng√†y,categoryDefault1,00b547,2,,,,,,
2025/6/17,400000,C√°p zflip5,Expense,20,Linh ki·ªán,category1,ffe666,3,,,,,,
2025/6/17,1400000,Zflip 5 khai,Income,19,Ti·ªÅn l√†m,category1,ffe666,12,,,,,,
2025/6/17,900000,Fx,Income,16,ƒê·∫ßu t∆∞,categoryDefault15,42d2c1,17,,,,,,
2025/6/17,750000,Tr·∫£ a ho√†ng ,Expense,20,Linh ki·ªán,category1,ffe666,3,,,,,,
2025/6/18,100000,ƒÇn s√°ng cf,Expense,2,Chi ti√™u h√†ng ng√†y,categoryDefault1,00b547,2,,,,,,
2025/6/18,250000,L∆∞ng + pq,Expense,20,Linh ki·ªán,category1,ffe666,3,,,,,,
2025/6/18,1500000,13prm ek l∆∞ng ,Income,19,Ti·ªÅn l√†m,category1,ffe666,12,,,,,,
2025/6/18,450000,C·∫£m xr khai,Income,19,Ti·ªÅn l√†m,category1,ffe666,12,,,,,,
2025/6/19,200000,ƒÇn s√°ng cf,Expense,1,ƒÇn u·ªëng,categoryDefault0,ff8700,1,,,,,,
2025/6/19,500000,C·∫£m xsm khai,Income,19,Ti·ªÅn l√†m,category1,ffe666,12,,,,,,
2025/6/19,450000,Xr c·∫£m khai,Income,19,Ti·ªÅn l√†m,category1,ffe666,12,,,,,,
2025/6/19,500000,Pin xsm kh√°ch l·∫ª,Income,19,Ti·ªÅn l√†m,category1,ffe666,12,,,,,,
2025/6/21,200000,Chi ti√™u,Expense,2,Chi ti√™u h√†ng ng√†y,categoryDefault1,00b547,2,,,,,,
2025/6/21,400000,K√≠nh 11prm nh√¢n,Income,19,Ti·ªÅn l√†m,category1,ffe666,12,,,,,,
2025/6/21,350000,Pin 8p ,Income,19,Ti·ªÅn l√†m,category1,ffe666,12,,,,,,
2025/6/21,650000,K√≠nh 11prm + c√°p ( nh√¢n ),Income,19,Ti·ªÅn l√†m,category1,ffe666,12,,,,,,
2025/6/21,450000,K√≠nh 12pro khai,Income,19,Ti·ªÅn l√†m,category1,ffe666,12,,,,,,
2025/6/21,700000,C√°p 13prm a ƒê√¥ng,Income,19,Ti·ªÅn l√†m,category1,ffe666,12,,,,,,
2025/7/2,190000,Mua g·∫°o,Expense,2,Chi ti√™u h√†ng ng√†y,categoryDefault1,00b547,2,,,,,,
2025/7/2,400000,C√°p zflip 5,Expense,20,Linh ki·ªán,category1,ffe666,3,,,,,,
2025/7/2,800000,C√°p zflip 5,Income,19,Ti·ªÅn l√†m,category1,ffe666,12,,,,,,
2025/7/3,310000,M√†n xs ,Expense,20,Linh ki·ªán,category1,ffe666,3,,,,,,
2025/7/3,380000,C·∫£m 12prm ,Expense,20,Linh ki·ªán,category1,ffe666,3,,,,,,
2025/7/3,500000,M√†n xs ,Income,19,Ti·ªÅn l√†m,category1,ffe666,12,,,,,,
2025/7/4,100000,ƒÇn s√°ng ,Expense,1,ƒÇn u·ªëng,categoryDefault0,ff8700,1,,,,,,
2025/7/4,100000,K√≠nh 12prm ,Expense,20,Linh ki·ªán,category1,ffe666,3,,,,,,
2025/7/4,700000,K√≠nh 12prm,Income,19,Ti·ªÅn l√†m,category1,ffe666,12,,,,,,
2025/7/4,350000,K√≠nh xsm,Income,19,Ti·ªÅn l√†m,category1,ffe666,12,,,,,,
2025/7/4,900000,C·∫£m 12prm ,Income,19,Ti·ªÅn l√†m,category1,ffe666,12,,,,,,
2025/7/4,198000,Mua b√°nh + √¥c,Expense,1,ƒÇn u·ªëng,categoryDefault0,ff8700,1,,,,,,
2025/7/4,750000,Mua m√†n 11prm ,Expense,20,Linh ki·ªán,category1,ffe666,3,,,,,,
2025/7/4,900000,M√†n 11prm,Income,19,Ti·ªÅn l√†m,category1,ffe666,12,,,,,,
2025/7/5,100000,ƒÇn s√°ng ,Expense,1,ƒÇn u·ªëng,categoryDefault0,ff8700,1,,,,,,
2025/7/5,220000,Ch·ª£ ,Expense,2,Chi ti√™u h√†ng ng√†y,categoryDefault1,00b547,2,,,,,,
2025/7/7,50000,ƒÇn s√°ng cf ,Expense,1,ƒÇn u·ªëng,categoryDefault0,ff8700,1,,,,,,
2025/7/7,500000,Mua linh ki·ªán,Expense,20,Linh ki·ªán,category1,ffe666,3,,,,,,
2025/7/7,500000,C·∫£m xsm ,Income,19,Ti·ªÅn l√†m,category1,ffe666,12,,,,,,
2025/7/7,900000,C·∫£m 12prm ,Income,19,Ti·ªÅn l√†m,category1,ffe666,12,,,,,,
2025/7/7,250000,Keo 2tp ,Expense,20,Linh ki·ªán,category1,ffe666,3,,,,,,
2025/7/9,150000,C·∫£m 11 pro max ,Expense,20,Linh ki·ªán,category1,ffe666,3,,,,,,
2025/7/9,550000,C·∫£m 11prm,Income,19,Ti·ªÅn l√†m,category1,ffe666,12,,,,,,
2025/7/9,500000,C·∫£m 11pro ( Khai ),Income,19,Ti·ªÅn l√†m,category1,ffe666,12,,,,,,
2025/7/10,540000,M√†n vivo v20fe,Expense,20,Linh ki·ªán,category1,ffe666,3,,,,,,
2025/7/10,25000,C∆°m ,Expense,1,ƒÇn u·ªëng,categoryDefault0,ff8700,1,,,,,,
2025/7/10,800000,M√†n vivo ,Income,19,Ti·ªÅn l√†m,category1,ffe666,12,,,,,,
2025/7/10,550000,C·∫£m 11pro max,Income,19,Ti·ªÅn l√†m,category1,ffe666,12,,,,,,
2025/7/10,260000,C·∫£m 11prm,Expense,20,Linh ki·ªán,category1,ffe666,3,,,,,,
2025/7/10,400000,K√≠nh xsm 400,Income,19,Ti·ªÅn l√†m,category1,ffe666,12,,,,,,
2025/7/11,50000,ƒÇn s√°n cf,Expense,1,ƒÇn u·ªëng,categoryDefault0,ff8700,1,,,,,,
2025/7/11,250000,Pin a15 ,Income,19,Ti·ªÅn l√†m,category1,ffe666,12,,,,,,
2025/7/11,140000,Cell a15 ,Expense,20,Linh ki·ªán,category1,ffe666,3,,,,,,
2025/7/11,400000,C·∫£m x ,Income,19,Ti·ªÅn l√†m,category1,ffe666,12,,,,,,
2025/7/11,30000,C∆°m tr∆∞a,Expense,1,ƒÇn u·ªëng,categoryDefault0,ff8700,1,,,,,,
2025/7/11,700000,"L∆∞ng, pin, flash 14pro l√£i",Income,19,Ti·ªÅn l√†m,category1,ffe666,12,,,,,,
2025/7/11,500000,Fix 13pro,Income,19,Ti·ªÅn l√†m,category1,ffe666,12,,,,,,
2025/7/11,300000,H·ªì c√° + c√°,Expense,2,Chi ti√™u h√†ng ng√†y,categoryDefault1,00b547,2,,,,,,
2025/7/11,300000,C√°p 11pro khai,Income,19,Ti·ªÅn l√†m,category1,ffe666,12,,,,,,
2025/7/11,700000,Fix 13pro max ,Income,19,Ti·ªÅn l√†m,category1,ffe666,12,,,,,,
2025/7/12,220000,M√†n a03,Expense,20,Linh ki·ªán,category1,ffe666,3,,,,,,
2025/7/12,80000,ƒÇn s√°ng cf,Expense,1,ƒÇn u·ªëng,categoryDefault0,ff8700,1,,,,,,
2025/7/12,90000,Mua l·ªçc,Expense,2,Chi ti√™u h√†ng ng√†y,categoryDefault1,00b547,2,,,,,,
2025/7/12,800000,Fix 13pro ,Income,19,Ti·ªÅn l√†m,category1,ffe666,12,,,,,,
2025/7/12,500000,Ek 13pro,Income,19,Ti·ªÅn l√†m,category1,ffe666,12,,,,,,
2025/7/12,800000,Fix 14pro max ,Income,19,Ti·ªÅn l√†m,category1,ffe666,12,,,,,,
2025/7/12,400000,Thay m√†n a03,Income,19,Ti·ªÅn l√†m,category1,ffe666,12,,,,,,
2025/7/12,400000,Thay m√†n redmi 9c,Income,19,Ti·ªÅn l√†m,category1,ffe666,12,,,,,,
2025/7/16,2500000,Sinh ho·∫°t ƒë√°m c∆∞·ªõi ƒÉn u·ªëng,Expense,2,Chi ti√™u h√†ng ng√†y,categoryDefault1,00b547,2,,,,,,
2025/7/18,500000,C·∫£m xsm ,Income,19,Ti·ªÅn l√†m,category1,ffe666,12,,,,,,
2025/7/18,900000,C·∫£m gen 10,Income,19,Ti·ªÅn l√†m,category1,ffe666,12,,,,,,
2025/7/18,860000,C·∫£m ·ª©ng ,Expense,20,Linh ki·ªán,category1,ffe666,3,,,,,,
2025/7/20,7000000,Ti·ªÅn nh√†,Expense,11,Ti·ªÅn nh√†,categoryDefault10,ffa400,20,,,,,,
2025/8/3,80000,ƒÇn s√°ng cf,Expense,1,ƒÇn u·ªëng,categoryDefault0,ff8700,1,,,,,,
2025/8/3,20000,Ch·ª£,Expense,1,ƒÇn u·ªëng,categoryDefault0,ff8700,1,,,,,,
2025/8/3,26000,Nu√¥i b√≤,Expense,1,ƒÇn u·ªëng,categoryDefault0,ff8700,1,,,,,,
2025/8/3,1000000,13prm ic ,Income,19,Ti·ªÅn l√†m,category1,ffe666,12,,,,,,
2025/8/3,700000,Ic k√≠nh ,Expense,20,Linh ki·ªán,category1,ffe666,3,,,,,,
2025/8/3,450000,K√≠nh 11prm,Income,19,Ti·ªÅn l√†m,category1,ffe666,12,,,,,,
2025/8/3,1500000,Mua m√†n ƒë·ªÅn,Expense,20,Linh ki·ªán,category1,ffe666,3,,,,,,
2025/8/3,700000,C√°p 12prm,Income,19,Ti·ªÅn l√†m,category1,ffe666,12,,,,,,
2025/8/2,100000,ƒÇn u·ªëng ch·ª£,Expense,1,ƒÇn u·ªëng,categoryDefault0,ff8700,1,,,,,,
2025/8/2,900000,Note 10p k√≠nh ,Expense,20,Linh ki·ªán,category1,ffe666,3,,,,,,
2025/8/2,1700000,Note 10p k√≠nh pin ,Income,19,Ti·ªÅn l√†m,category1,ffe666,12,,,,,,
2025/8/3,300000,Frp ss ,Income,19,Ti·ªÅn l√†m,category1,ffe666,12,,,,,,
2025/8/3,1200000,K√≠nh 13prm + fix ,Income,19,Ti·ªÅn l√†m,category1,ffe666,12,,,,,,
2025/8/3,700000,Fix 13prm,Income,19,Ti·ªÅn l√†m,category1,ffe666,12,,,,,,
2025/8/2,350000,Kh√°m b·ªánh cho G·∫°o,Expense,6,Y t·∫ø,categoryDefault6,61e396,7,,,,,,
2025/8/4,600000,ƒÇn u·ªëng sinh nh·∫≠t,Expense,1,ƒÇn u·ªëng,categoryDefault0,ff8700,1,,,,,,
2025/8/4,500000,K nh·ªõ ,Income,19,Ti·ªÅn l√†m,category1,ffe666,12,,,,,,
2025/8/5,150000,ƒÇn s√°ng ch·ª£,Expense,2,Chi ti√™u h√†ng ng√†y,categoryDefault1,00b547,2,,,,,,
2025/8/5,700000,K√≠nh 12pm,Income,19,Ti·ªÅn l√†m,category1,ffe666,12,,,,,,
2025/8/5,100000,K√≠nh 12pm ,Expense,20,Linh ki·ªán,category1,ffe666,3,,,,,,
2025/8/6,140000,ƒÇn s√°ng cf chi ti√™u,Expense,2,Chi ti√™u h√†ng ng√†y,categoryDefault1,00b547,2,,,,,,
2025/8/6,700000,Fix 13pm ,Income,19,Ti·ªÅn l√†m,category1,ffe666,12,,,,,,
2025/8/6,1500000,C·∫£m 14pm,Income,19,Ti·ªÅn l√†m,category1,ffe666,12,,,,,,
2025/8/6,750000,C·∫£m 14pm,Expense,20,Linh ki·ªán,category1,ffe666,3,,,,,,
2025/8/7,86000,Thu·ªëc 86,Expense,6,Y t·∫ø,categoryDefault6,61e396,7,,,,,,
2025/8/7,100000,ƒÇn s√°ng cf ch·ª£ 100,Expense,2,Chi ti√™u h√†ng ng√†y,categoryDefault1,00b547,2,,,,,,
2025/8/7,220000,Pin + c√°p 12p,Expense,20,Linh ki·ªán,category1,ffe666,3,,,,,,
2025/8/7,150000,C·∫£m xsm 150,Expense,20,Linh ki·ªán,category1,ffe666,3,,,,,,
2025/8/7,500000,C·∫£m xsm ,Income,19,Ti·ªÅn l√†m,category1,ffe666,12,,,,,,
2025/8/7,700000,Fix 13pm,Income,19,Ti·ªÅn l√†m,category1,ffe666,12,,,,,,
2025/8/7,180000,K√≠nh 8p,Income,19,Ti·ªÅn l√†m,category1,ffe666,12,,,,,,
2025/8/7,50000,K√≠nh 8p,Expense,20,Linh ki·ªán,category1,ffe666,3,,,,,,
2025/8/7,900000,K√≠nh 11pm + k√≠nh 12p,Income,19,Ti·ªÅn l√†m,category1,ffe666,12,,,,,,
2025/8/7,700000,M√†n x,Income,19,Ti·ªÅn l√†m,category1,ffe666,12,,,,,,
2025/8/8,8000,Thu·ªëc ,Expense,6,Y t·∫ø,categoryDefault6,61e396,7,,,,,,
2025/8/8,45000,ƒÇn s√°ng ,Expense,1,ƒÇn u·ªëng,categoryDefault0,ff8700,1,,,,,,
2025/8/8,40000,Cf ,Expense,1,ƒÇn u·ªëng,categoryDefault0,ff8700,1,,,,,,
2025/8/8,200000,K√≠nh a23,Income,19,Ti·ªÅn l√†m,category1,ffe666,12,,,,,,
2025/8/9,70000,ƒÇn s√°ng g·∫°o cf,Expense,2,Chi ti√™u h√†ng ng√†y,categoryDefault1,00b547,2,,,,,,
2025/8/9,400000,C·∫£m x,Income,19,Ti·ªÅn l√†m,category1,ffe666,12,,,,,,
2025/8/7,500000,Mua ƒë·ªì trang ƒëi·ªÉm ,Expense,2,Chi ti√™u h√†ng ng√†y,categoryDefault1,00b547,2,,,,,,
2025/8/8,350000,"Mua s·ªØa t·∫Øm, t·∫©y trang",Expense,2,Chi ti√™u h√†ng ng√†y,categoryDefault1,00b547,2,,,,,,
2025/8/9,600000,M√†n xs,Income,19,Ti·ªÅn l√†m,category1,ffe666,12,,,,,,
2025/8/9,350000,Mua m√†n xs,Expense,20,Linh ki·ªán,category1,ffe666,3,,,,,,
2025/8/9,170000,Cf gia ƒë√¨nh ,Expense,1,ƒÇn u·ªëng,categoryDefault0,ff8700,1,,,,,,
2025/8/10,80000,ƒÇn s√°ng 80,Expense,1,ƒÇn u·ªëng,categoryDefault0,ff8700,1,,,,,,
2025/8/10,27000,Cf,Expense,1,ƒÇn u·ªëng,categoryDefault0,ff8700,1,,,,,,
2025/8/10,75000,ƒÇn c√∫t tr·ª©ng ,Expense,1,ƒÇn u·ªëng,categoryDefault0,ff8700,1,,,,,,
2025/8/11,70000,ƒÇn s√°ng cf 70k,Expense,1,ƒÇn u·ªëng,categoryDefault0,ff8700,1,,,,,,
2025/8/11,700000,13pm ,Income,19,Ti·ªÅn l√†m,category1,ffe666,12,,,,,,
2025/8/11,650000,Xsm k√≠nh + l∆∞ng ,Income,19,Ti·ªÅn l√†m,category1,ffe666,12,,,,,,
2025/8/11,150000,L∆∞ng xsm + k√≠nh camera ,Expense,20,Linh ki·ªán,category1,ffe666,3,,,,,,
2025/8/11,10000,N∆∞·ªõc m√≠a ,Expense,1,ƒÇn u·ªëng,categoryDefault0,ff8700,1,,,,,,
2025/8/11,28000,Thu·ªëc vai g√°y,Expense,6,Y t·∫ø,categoryDefault6,61e396,7,,,,,,
2025/8/11,350000,K√≠nh 11pm,Income,19,Ti·ªÅn l√†m,category1,ffe666,12,,,,,,
2025/8/11,110000,Mua khƒÉn ,Expense,1,ƒÇn u·ªëng,categoryDefault0,ff8700,1,,,,,,
2025/8/11,30000,K√≠nh cam xsm,Expense,20,Linh ki·ªán,category1,ffe666,3,,,,,,
2025/8/12,550000,C·∫£m 11pm,Income,19,Ti·ªÅn l√†m,category1,ffe666,12,,,,,,
2025/8/12,150000,C·∫£m 11prm,Expense,20,Linh ki·ªán,category1,ffe666,3,,,,,,
2025/8/13,1160000,S·ªØa xe,Expense,2,Chi ti√™u h√†ng ng√†y,categoryDefault1,00b547,2,,,,,,
2025/8/13,300000,Mua c·∫£m ·ª©ng ,Expense,20,Linh ki·ªán,category1,ffe666,3,,,,,,
2025/8/13,100000,ƒÇn u·ªëng cf,Expense,1,ƒÇn u·ªëng,categoryDefault0,ff8700,1,,,,,,
2025/8/16,2600000,ƒê√† lat,Expense,2,Chi ti√™u h√†ng ng√†y,categoryDefault1,00b547,2,,,,,,
2025/8/6,1250000,Ti·ªÅn ƒëi·ªán,Expense,2,Chi ti√™u h√†ng ng√†y,categoryDefault1,00b547,2,,,,,,
2025/8/18,80000,ƒÇn u·ªëng ,Expense,1,ƒÇn u·ªëng,categoryDefault0,ff8700,1,,,,,,
2025/8/18,600000,Fix 13pro,Income,19,Ti·ªÅn l√†m,category1,ffe666,12,,,,,,
2025/8/18,450000,Ek 13,Income,19,Ti·ªÅn l√†m,category1,ffe666,12,,,,,,
2025/8/19,680000,Mua lk,Expense,20,Linh ki·ªán,category1,ffe666,3,,,,,,
2025/8/19,60000,Cf ƒÉn sang,Expense,1,ƒÇn u·ªëng,categoryDefault0,ff8700,1,,,,,,
2025/8/19,1400000,V·ªè m√†n 8p,Income,19,Ti·ªÅn l√†m,category1,ffe666,12,,,,,,
2025/8/19,1000000,Fix 13pm,Income,19,Ti·ªÅn l√†m,category1,ffe666,12,,,,,,
2025/8/18,400000,ƒê√°m c∆∞·ªõi,Expense,2,Chi ti√™u h√†ng ng√†y,categoryDefault1,00b547,2,,,,,,
2025/8/19,55000,G√† ,Expense,1,ƒÇn u·ªëng,categoryDefault0,ff8700,1,,,,,,
2025/8/19,100000,Ch√¢n g√† bia,Expense,1,ƒÇn u·ªëng,categoryDefault0,ff8700,1,,,,,,
2025/8/20,100000,Chi ti√™u,Expense,2,Chi ti√™u h√†ng ng√†y,categoryDefault1,00b547,2,,,,,,
2025/8/20,90000,Mua sac ,Expense,20,Linh ki·ªán,category1,ffe666,3,,,,,,
2025/8/20,500000,11pro,Income,19,Ti·ªÅn l√†m,category1,ffe666,12,,,,,,
2025/8/20,170000,S·∫°c,Income,15,Thu nh·∫≠p ph·ª•,categoryDefault14,00c7ff,16,,,,,,
2025/8/26,8200000,Ti·ªÅn ng√¢n h√†ng,Expense,21,Ng√¢n h√†ng,category1,ffe666,21,,,,,,
2025/9/19,80000,ƒÇn s√°ng cf,Expense,1,ƒÇn u·ªëng,categoryDefault0,ff8700,1,,,,,,
2025/9/19,600000,Momo,Expense,21,Ng√¢n h√†ng,category1,ffe666,21,,,,,,
2025/9/19,200000,M√°y l·∫°nh ,Expense,2,Chi ti√™u h√†ng ng√†y,categoryDefault1,00b547,2,,,,,,
2025/9/27,350000,K√≠nh 11 huy t·∫•n c∆∞·ªùng,Income,19,Ti·ªÅn l√†m,category1,ffe666,12,,,,,,
2025/9/20,70000,ƒÇn u·ªëng cf,Expense,1,ƒÇn u·ªëng,categoryDefault0,ff8700,1,,,,,,
2025/9/20,1700000,M√†n 13pm lk ,Expense,20,Linh ki·ªán,category1,ffe666,3,,,,,,
2025/9/20,2200000,Thay m√†n 13pm oled ,Income,19,Ti·ªÅn l√†m,category1,ffe666,12,,,,,,
2025/9/22,105000,Cf ƒÉn u·ªëng ,Expense,1,ƒÇn u·ªëng,categoryDefault0,ff8700,1,,,,,,
2025/9/22,300000,Xsm c√°p ,Income,19,Ti·ªÅn l√†m,category1,ffe666,12,,,,,,
2025/9/22,350000,Xsm k√≠nh ( chuy√™n ),Income,19,Ti·ªÅn l√†m,category1,ffe666,12,,,,,,
2025/9/22,800000,C√°p 13pm,Income,19,Ti·ªÅn l√†m,category1,ffe666,12,,,,,,
2025/9/22,75000,G·ªèi ,Expense,1,ƒÇn u·ªëng,categoryDefault0,ff8700,1,,,,,,
2025/9/22,40000,T·∫°p ho√°,Expense,2,Chi ti√™u h√†ng ng√†y,categoryDefault1,00b547,2,,,,,,
2025/9/22,298000,S·ªØa con,Expense,2,Chi ti√™u h√†ng ng√†y,categoryDefault1,00b547,2,,,,,,
2025/9/23,100000,ƒÇn s√°ng ,Expense,1,ƒÇn u·ªëng,categoryDefault0,ff8700,1,,,,,,
2025/9/23,76000,Ch·ª£,Expense,2,Chi ti√™u h√†ng ng√†y,categoryDefault1,00b547,2,,,,,,
2025/9/23,165000,Mua d√°n t∆∞·ªùng ,Expense,2,Chi ti√™u h√†ng ng√†y,categoryDefault1,00b547,2,,,,,,
2025/9/23,55000,Gi·∫•y m√¨,Expense,2,Chi ti√™u h√†ng ng√†y,categoryDefault1,00b547,2,,,,,,
2025/9/23,400000,Pin 13pm ,Income,19,Ti·ªÅn l√†m,category1,ffe666,12,,,,,,
2025/9/23,850000,L∆∞ng 11pm cell c√°p loa ,Income,19,Ti·ªÅn l√†m,category1,ffe666,12,,,,,,
2025/9/23,195000,C·∫£m xsm ,Expense,20,Linh ki·ªán,category1,ffe666,3,,,,,,
2025/9/23,110000,D√¢y loa 11pm,Expense,20,Linh ki·ªán,category1,ffe666,3,,,,,,
2025/9/23,125000,L∆∞ng 11pm lt,Expense,20,Linh ki·ªán,category1,ffe666,3,,,,,,
2025/9/23,550000,Pin 14pm,Income,19,Ti·ªÅn l√†m,category1,ffe666,12,,,,,,
2025/9/23,500000,C·∫£m xsm,Income,19,Ti·ªÅn l√†m,category1,ffe666,12,,,,,,
2025/9/23,380000,Pin 12pm drp,Expense,20,Linh ki·ªán,category1,ffe666,3,,,,,,
2025/9/23,500000, pin 12pm ,Income,19,Ti·ªÅn l√†m,category1,ffe666,12,,,,,,
2025/9/23,243000,B√°ch ho√° xanh,Expense,2,Chi ti√™u h√†ng ng√†y,categoryDefault1,00b547,2,,,,,,
2025/9/23,250000,G·∫°o d·∫ßu ƒÉn,Expense,2,Chi ti√™u h√†ng ng√†y,categoryDefault1,00b547,2,,,,,,
2025/9/23,177000,Uy√™n uy√™n ,Expense,2,Chi ti√™u h√†ng ng√†y,categoryDefault1,00b547,2,,,,,,
2025/9/23,104000,Uy√™n uy√™n ,Expense,2,Chi ti√™u h√†ng ng√†y,categoryDefault1,00b547,2,,,,,,
2025/9/24,18000,C√† ph√™,Expense,1,ƒÇn u·ªëng,categoryDefault0,ff8700,1,,,,,,
2025/9/24,70000,ƒÇn s√°ng ,Expense,1,ƒÇn u·ªëng,categoryDefault0,ff8700,1,,,,,,
2025/9/24,18000,Ch·ª£,Expense,1,ƒÇn u·ªëng,categoryDefault0,ff8700,1,,,,,,
2025/9/24,450000,K√≠nh 12p Chuy√™n,Income,19,Ti·ªÅn l√†m,category1,ffe666,12,,,,,,
2025/9/24,240000,C·∫£m salaman,Expense,20,Linh ki·ªán,category1,ffe666,3,,,,,,
2025/9/24,500000,C·∫£m xsm huy t·∫•n c∆∞·ªùng,Income,19,Ti·ªÅn l√†m,category1,ffe666,12,,,,,,
2025/9/24,700000,Fix 13pm Ho√†ng Ba T√†u,Income,19,Ti·ªÅn l√†m,category1,ffe666,12,,,,,,
2025/9/24,150000,L∆∞ng 12pm ,Expense,20,Linh ki·ªán,category1,ffe666,3,,,,,,
2025/9/24,400000,Thay l∆∞ng 12pm qu·ªëc,Income,19,Ti·ªÅn l√†m,category1,ffe666,12,,,,,,
2025/9/24,700000,Fix 13pm Lee,Income,19,Ti·ªÅn l√†m,category1,ffe666,12,,,,,,
2025/9/25,70000,ƒÇn s√°ng cf,Expense,1,ƒÇn u·ªëng,categoryDefault0,ff8700,1,,,,,,
2025/9/25,400000,C·∫£m xs Duy Vi·ªát,Income,19,Ti·ªÅn l√†m,category1,ffe666,12,,,,,,
2025/9/25,290000,Mua c·∫£m ipad gen10 ,Expense,20,Linh ki·ªán,category1,ffe666,3,,,,,,
2025/9/25,850000,C·∫£m gen 10 ,Income,19,Ti·ªÅn l√†m,category1,ffe666,12,,,,,,
2025/9/25,700000,Fix 13pm Nh·ªõ mobile,Income,19,Ti·ªÅn l√†m,category1,ffe666,12,,,,,,
2025/9/25,190000,190,Expense,2,Chi ti√™u h√†ng ng√†y,categoryDefault1,00b547,2,,,,,,
2025/9/26,20000,Cf ,Expense,1,ƒÇn u·ªëng,categoryDefault0,ff8700,1,,,,,,
2025/9/26,100000,Kh√°ch bo ,Income,15,Thu nh·∫≠p ph·ª•,categoryDefault14,00c7ff,16,,,,,,
2025/9/26,250000,Pin X ,Expense,20,Linh ki·ªán,category1,ffe666,3,,,,,,
2025/9/26,170000,C·∫£m xsm,Expense,20,Linh ki·ªán,category1,ffe666,3,,,,,,
2025/9/26,450000,Pin x ,Income,19,Ti·ªÅn l√†m,category1,ffe666,12,,,,,,
2025/9/26,500000,C·∫£m xsm Th·ªãnh,Income,19,Ti·ªÅn l√†m,category1,ffe666,12,,,,,,
2025/9/26,250000,Pin 6p,Income,19,Ti·ªÅn l√†m,category1,ffe666,12,,,,,,
2025/9/27,60000,ƒÇn s√°ng cf ,Expense,1,ƒÇn u·ªëng,categoryDefault0,ff8700,1,,,,,,
2025/9/27,180000,Pin 7p,Expense,20,Linh ki·ªán,category1,ffe666,3,,,,,,
2025/9/27,350000,Thay pin 7p,Income,19,Ti·ªÅn l√†m,category1,ffe666,12,,,,,,
2025/9/27,60000,ƒÇn s√°ng cf,Expense,1,ƒÇn u·ªëng,categoryDefault0,ff8700,1,,,,,,
2025/9/27,320000,Mua lk,Expense,20,Linh ki·ªán,category1,ffe666,3,,,,,,
2025/9/28,70000,ƒÇn s√°ng cf,Expense,1,ƒÇn u·ªëng,categoryDefault0,ff8700,1,,,,,,
2025/9/28,320000,Lk ,Expense,20,Linh ki·ªán,category1,ffe666,3,,,,,,
2025/9/28,150000,C·∫£m 11pm,Expense,20,Linh ki·ªán,category1,ffe666,3,,,,,,
2025/9/28,550000,C·∫£m 11pm,Income,19,Ti·ªÅn l√†m,category1,ffe666,12,,,,,,
2025/9/28,350000,K√≠nh 11 huy t·∫•n c∆∞·ªùng,Income,19,Ti·ªÅn l√†m,category1,ffe666,12,,,,,,
2025/9/28,380000,Y·∫øn,Expense,2,Chi ti√™u h√†ng ng√†y,categoryDefault1,00b547,2,,,,,,
2025/9/28,100000,C∆∞·ªùng l·ª±c,Income,15,Thu nh·∫≠p ph·ª•,categoryDefault14,00c7ff,16,,,,,,
2025/9/29,70000,ƒÇn s√°ng cf ,Expense,1,ƒÇn u·ªëng,categoryDefault0,ff8700,1,,,,,,
2025/9/29,10000,Rau,Expense,2,Chi ti√™u h√†ng ng√†y,categoryDefault1,00b547,2,,,,,,
2025/9/29,150000,C·∫£m xsm ,Expense,20,Linh ki·ªán,category1,ffe666,3,,,,,,
2025/9/29,500000,C·∫£m xsm La duy,Income,19,Ti·ªÅn l√†m,category1,ffe666,12,,,,,,
2025/9/29,500000,C·∫£m xsm Ph∆∞∆°ng Duy,Income,19,Ti·ªÅn l√†m,category1,ffe666,12,,,,,,
2025/9/29,800000,C√°p 14pro Th√†nh Vinh,Income,19,Ti·ªÅn l√†m,category1,ffe666,12,,,,,,
2025/9/27,1600000,ƒê√≥ng ng√¢n h√†ng,Expense,21,Ng√¢n h√†ng,category1,ffe666,21,,,,,,
2025/9/30,200000,Ch·ª£ ƒÉn s√°ng cf,Expense,2,Chi ti√™u h√†ng ng√†y,categoryDefault1,00b547,2,,,,,,
2025/9/30,400000,M√†n 12,Income,19,Ti·ªÅn l√†m,category1,ffe666,12,,,,,,
2025/10/1,400000,ƒÇn s√°ng cf chi linh tinh,Expense,2,Chi ti√™u h√†ng ng√†y,categoryDefault1,00b547,2,,,,,,
2025/10/1,1750000,Mua m√†n s20ultra ,Expense,20,Linh ki·ªán,category1,ffe666,3,,,,,,
2025/10/2,2200000,Thay m√†n s20ultra oled,Income,19,Ti·ªÅn l√†m,category1,ffe666,12,,,,,,
2025/10/2,50000,ƒÇn s√°ng cf,Expense,1,ƒÇn u·ªëng,categoryDefault0,ff8700,1,,,,,,
2025/10/3,180000,Ch·ª£ cf ƒÉn s√°ng ,Expense,1,ƒÇn u·ªëng,categoryDefault0,ff8700,1,,,,,,
2025/10/3,500000,L∆∞ng 12pm,Income,19,Ti·ªÅn l√†m,category1,ffe666,12,,,,,,
2025/10/3,100000,B·∫Øn l∆∞ng 100k ,Expense,20,Linh ki·ªán,category1,ffe666,3,,,,,,
2025/10/3,450000,L∆∞ng 14pro ,Income,19,Ti·ªÅn l√†m,category1,ffe666,12,,,,,,
2025/10/3,600000,Fix 13pro ƒë√¥ng ,Income,19,Ti·ªÅn l√†m,category1,ffe666,12,,,,,,
2025/10/3,400000,B√°n m√†n 13pm l√™ hi·ªÉn l√£i,Income,15,Thu nh·∫≠p ph·ª•,categoryDefault14,00c7ff,16,,,,,,
2025/10/3,90000,B√°nh trung thu,Expense,1,ƒÇn u·ªëng,categoryDefault0,ff8700,1,,,,,,
2025/10/3,500000,Mua m√†n 13pm,Expense,20,Linh ki·ªán,category1,ffe666,3,,,,,,
2025/10/3,1600000,B√°n m√†n 13prm Danh,Income,15,Thu nh·∫≠p ph·ª•,categoryDefault14,00c7ff,16,,,,,,
2025/10/3,1500000,Ti·ªÅn g·ª≠i √öt,Expense,2,Chi ti√™u h√†ng ng√†y,categoryDefault1,00b547,2,,,,,,
2025/10/4,120000,"Ch·ª£, ƒÉn s√°ng cf",Expense,2,Chi ti√™u h√†ng ng√†y,categoryDefault1,00b547,2,,,,,,
2025/10/4,200000,C·∫£m xr ,Expense,20,Linh ki·ªán,category1,ffe666,3,,,,,,
2025/10/4,500000,K√≠nh xsm Rin,Income,19,Ti·ªÅn l√†m,category1,ffe666,12,,,,,,
2025/10/4,450000,C·∫£m 11prm khai,Income,19,Ti·ªÅn l√†m,category1,ffe666,12,,,,,,
2025/10/4,480000,Si√™u th·ªã,Expense,2,Chi ti√™u h√†ng ng√†y,categoryDefault1,00b547,2,,,,,,
2025/10/4,500000,Si√™u th·ªã ,Expense,2,Chi ti√™u h√†ng ng√†y,categoryDefault1,00b547,2,,,,,,
2025/10/5,200000,Mua m√†n xr ,Expense,20,Linh ki·ªán,category1,ffe666,3,,,,,,
2025/10/5,80000,ƒÇn s√°ng cf ,Expense,1,ƒÇn u·ªëng,categoryDefault0,ff8700,1,,,,,,
2025/10/5,1220000,Tr·∫£ linh ki·ªán ,Expense,20,Linh ki·ªán,category1,ffe666,3,,,,,,
2025/10/6,50000,ƒÇn s√°ng ,Expense,1,ƒÇn u·ªëng,categoryDefault0,ff8700,1,,,,,,
2025/10/6,300000,Ti·ªÅn chi linh tinh,Expense,2,Chi ti√™u h√†ng ng√†y,categoryDefault1,00b547,2,,,,,,
2025/10/6,700000,Fix 13prm thi·ªán,Income,19,Ti·ªÅn l√†m,category1,ffe666,12,,,,,,
2025/10/7,70000,ƒÇn s√°ng cf 70,Expense,1,ƒÇn u·ªëng,categoryDefault0,ff8700,1,,,,,,
2025/10/7,180000,Pin 8p ,Expense,20,Linh ki·ªán,category1,ffe666,3,,,,,,
2025/10/7,350000,Pin 8p Hoan,Income,19,Ti·ªÅn l√†m,category1,ffe666,12,,,,,,
2025/10/7,500000,C·∫£m xsm khai,Income,19,Ti·ªÅn l√†m,category1,ffe666,12,,,,,,
2025/10/7,170000,Mua c·∫£m xsm,Expense,20,Linh ki·ªán,category1,ffe666,3,,,,,,
2025/10/7,400000,C·∫£m x,Income,19,Ti·ªÅn l√†m,category1,ffe666,12,,,,,,
2025/10/8,130000,Ch·ª£ ƒÉn s√°ng ,Expense,2,Chi ti√™u h√†ng ng√†y,categoryDefault1,00b547,2,,,,,,
2025/10/8,180000,K√≠nh linh ki·ªán ,Expense,20,Linh ki·ªán,category1,ffe666,3,,,,,,
2025/10/8,300000,K√≠nh 11 Nh√¢n ,Income,19,Ti·ªÅn l√†m,category1,ffe666,12,,,,,,
2025/10/8,450000,K√≠nh xiaomi ,Income,19,Ti·ªÅn l√†m,category1,ffe666,12,,,,,,
2025/10/8,1200000,Ti·ªÅn cod,Income,15,Thu nh·∫≠p ph·ª•,categoryDefault14,00c7ff,16,,,,,,
2025/10/9,88000,Thu·ªëc ,Expense,6,Y t·∫ø,categoryDefault6,61e396,7,,,,,,
2025/10/9,70000,ƒÇm s√°ng cf,Expense,1,ƒÇn u·ªëng,categoryDefault0,ff8700,1,,,,,,
2025/10/9,360000,Mua c·∫£m xr l∆∞ng laser 360k ,Expense,20,Linh ki·ªán,category1,ffe666,3,,,,,,
2025/10/9,700000,S·ªØa 15prm n∆∞·ªõc ,Expense,20,Linh ki·ªán,category1,ffe666,3,,,,,,
2025/10/9,700000,Xr kh√°ch l·∫ª c·∫£m l∆∞ng ,Income,19,Ti·ªÅn l√†m,category1,ffe666,12,,,,,,
2025/10/9,450000,L∆∞ng 15prm ,Expense,20,Linh ki·ªán,category1,ffe666,3,,,,,,
2025/10/9,2000000,15prm thay l∆∞ng s·ª≠a ngu·ªìn ,Income,19,Ti·ªÅn l√†m,category1,ffe666,12,,,,,,
2025/10/9,700000,Fix 13prm ho√†ng ba t√†u,Income,19,Ti·ªÅn l√†m,category1,ffe666,12,,,,,,
2025/10/10,80000,ƒÇn s√°ng ch·ª£,Expense,1,ƒÇn u·ªëng,categoryDefault0,ff8700,1,,,,,,
2025/10/10,1750000,Mua m√†n s22u ,Expense,20,Linh ki·ªán,category1,ffe666,3,,,,,,
2025/10/10,2200000,Thay m√†n s22u ,Income,19,Ti·ªÅn l√†m,category1,ffe666,12,,,,,,
2025/10/10,800000,C√°p 14pm vinh,Income,19,Ti·ªÅn l√†m,category1,ffe666,12,,,,,,
2025/10/11,45000,ƒÇn s√°ng ,Expense,1,ƒÇn u·ªëng,categoryDefault0,ff8700,1,,,,,,
2025/10/11,150000,7p,Income,19,Ti·ªÅn l√†m,category1,ffe666,12,,,,,,
2025/10/11,280000,M·ªπ ph·∫©m ,Expense,2,Chi ti√™u h√†ng ng√†y,categoryDefault1,00b547,2,,,,,,
2025/10/11,200000,ƒê·ªì ch∆°i cho G·∫°o,Expense,2,Chi ti√™u h√†ng ng√†y,categoryDefault1,00b547,2,,,,,,
2025/10/12,50000,ƒÇn s√°ng ,Expense,1,ƒÇn u·ªëng,categoryDefault0,ff8700,1,,,,,,
2025/10/12,20000,Ship ,Expense,2,Chi ti√™u h√†ng ng√†y,categoryDefault1,00b547,2,,,,,,
2025/10/12,160000,Linh ki·ªán,Expense,20,Linh ki·ªán,category1,ffe666,3,,,,,,
2025/10/12,500000,K√≠nh seri4 40 mai ph√∫ quy,Income,19,Ti·ªÅn l√†m,category1,ffe666,12,,,,,,
2025/10/12,1000000,Ic 13pm La Duy,Income,19,Ti·ªÅn l√†m,category1,ffe666,12,,,,,,
2025/10/12,200000,Ch∆°,Expense,2,Chi ti√™u h√†ng ng√†y,categoryDefault1,00b547,2,,,,,,
2025/10/12,1500000,Ti·ªÅn ng√¢n h√†ng ,Expense,21,Ng√¢n h√†ng,category1,ffe666,21,,,,,,
2025/10/12,115000,Tr√† s·ªØa ,Expense,1,ƒÇn u·ªëng,categoryDefault0,ff8700,1,,,,,,
2025/10/13,50000,ƒÇn s√°ng ,Expense,1,ƒÇn u·ªëng,categoryDefault0,ff8700,1,,,,,,
2025/10/13,400000,C·∫£m 14prm,Expense,20,Linh ki·ªán,category1,ffe666,3,,,,,,
2025/10/13,1500000,C·∫£m 14pm Nam Van,Income,19,Ti·ªÅn l√†m,category1,ffe666,12,,,,,,
2025/10/13,900000,C∆° zflip 4 an mobile,Income,19,Ti·ªÅn l√†m,category1,ffe666,12,,,,,,
2025/10/13,700000,Fix 13prm hoang ba tau,Income,19,Ti·ªÅn l√†m,category1,ffe666,12,,,,,,
2025/10/13,800000,C√°p 13pm Ki,Income,19,Ti·ªÅn l√†m,category1,ffe666,12,,,,,,
2025/10/14,60000,Ch·ª£ ƒÉn s√°ng ,Expense,1,ƒÇn u·ªëng,categoryDefault0,ff8700,1,,,,,,
2025/10/14,200000,Ron 14pm ,Income,19,Ti·ªÅn l√†m,category1,ffe666,12,,,,,,
2025/10/14,240000,M√†n 7p dr ,Expense,20,Linh ki·ªán,category1,ffe666,3,,,,,,
2025/10/15,60000,ƒÇn s√°ng cf,Expense,1,ƒÇn u·ªëng,categoryDefault0,ff8700,1,,,,,,
2025/10/15,700000,Fix 13pm QuocPham,Income,19,Ti·ªÅn l√†m,category1,ffe666,12,,,,,,
2025/10/16,60000,ƒÇn u·ªëng,Expense,1,ƒÇn u·ªëng,categoryDefault0,ff8700,1,,,,,,
2025/10/16,235000,Y·∫øn ,Expense,2,Chi ti√™u h√†ng ng√†y,categoryDefault1,00b547,2,,,,,,
2025/10/16,400000,K√≠nh seri 4 l√£i,Income,19,Ti·ªÅn l√†m,category1,ffe666,12,,,,,,
2025/10/17,700000,13pro max a tr·ª±c,Income,19,Ti·ªÅn l√†m,category1,ffe666,12,,,,,,
2025/10/17,45000,ƒÇn s√°ng cf ,Expense,1,ƒÇn u·ªëng,categoryDefault0,ff8700,1,,,,,,
2025/10/17,700000,K√≠nh 12prm khai,Income,19,Ti·ªÅn l√†m,category1,ffe666,12,,,,,,
2025/10/17,150000,K√≠nh v·ªõi laser 12prm ,Expense,20,Linh ki·ªán,category1,ffe666,3,,,,,,
2025/10/17,700000,Fix 13prm Long,Income,19,Ti·ªÅn l√†m,category1,ffe666,12,,,,,,
2025/10/17,400000,C·∫£m X qu·ªëc ,Income,19,Ti·ªÅn l√†m,category1,ffe666,12,,,,,,
2025/10/17,700000,Mua m√†n 13prm ,Expense,20,Linh ki·ªán,category1,ffe666,3,,,,,,
2025/10/17,351000,Si√™u th·ªã,Expense,2,Chi ti√™u h√†ng ng√†y,categoryDefault1,00b547,2,,,,,,
2025/10/17,60000,ƒÇn t·ªëi ,Expense,1,ƒÇn u·ªëng,categoryDefault0,ff8700,1,,,,,,
2025/10/17,70000,N∆∞·ªõc ,Expense,1,ƒÇn u·ªëng,categoryDefault0,ff8700,1,,,,,,
2025/10/18,60000,Th·ªãt ,Expense,1,ƒÇn u·ªëng,categoryDefault0,ff8700,1,,,,,,
2025/10/18,17000,B√≠,Expense,1,ƒÇn u·ªëng,categoryDefault0,ff8700,1,,,,,,
2025/10/18,15000,ƒÇn s√°ng G·∫°o,Expense,1,ƒÇn u·ªëng,categoryDefault0,ff8700,1,,,,,,
2025/10/18,19000,Cf,Expense,1,ƒÇn u·ªëng,categoryDefault0,ff8700,1,,,,,,
2025/10/15,3500000,Ti·ªÅn nh√†,Expense,11,Ti·ªÅn nh√†,categoryDefault10,ffa400,20,,,,,,
2025/10/18,500000,Thay m√†n 8p ,Income,19,Ti·ªÅn l√†m,category1,ffe666,12,,,,,,
2025/10/19,300000,ƒÇn s√°ng ch·ª£ ,Expense,1,ƒÇn u·ªëng,categoryDefault0,ff8700,1,,,,,,
2025/10/19,85000,XƒÉng ,Expense,2,Chi ti√™u h√†ng ng√†y,categoryDefault1,00b547,2,,,,,,
2025/10/19,800000,14pro Ki,Income,19,Ti·ªÅn l√†m,category1,ffe666,12,,,,,,
2025/10/19,800000,B√°n 15pm,Income,19,Ti·ªÅn l√†m,category1,ffe666,12,,,,,,
2025/10/19,229000,ƒÇn ·ªëc,Expense,1,ƒÇn u·ªëng,categoryDefault0,ff8700,1,,,,,,
2025/10/20,80000,ƒÇn s√°ng cf,Expense,1,ƒÇn u·ªëng,categoryDefault0,ff8700,1,,,,,,
2025/10/20,200000,Ch·ª£,Expense,2,Chi ti√™u h√†ng ng√†y,categoryDefault1,00b547,2,,,,,,
2025/10/20,700000,Fix 13pro max la duy,Income,19,Ti·ªÅn l√†m,category1,ffe666,12,,,,,,
2025/10/20,700000,Fix m√†n 13prm ,Income,19,Ti·ªÅn l√†m,category1,ffe666,12,,,,,,
2025/10/20,1700000,B√°n m√†n 13pro max nh·ªõ,Income,15,Thu nh·∫≠p ph·ª•,categoryDefault14,00c7ff,16,,,,,,
2025/10/22,1450000,Vacxin cho G·∫°o,Expense,6,Y t·∫ø,categoryDefault6,61e396,7,,,,,,
2025/10/22,50000,ƒÇn s√°ng ,Expense,1,ƒÇn u·ªëng,categoryDefault0,ff8700,1,,,,,,
2025/10/22,700000,B√°n 11pm l√£i,Income,15,Thu nh·∫≠p ph·ª•,categoryDefault14,00c7ff,16,,,,,,
2025/10/22,700000,Fix m√†n 13pro max ho√†ng ba t√†u,Income,19,Ti·ªÅn l√†m,category1,ffe666,12,,,,,,
2025/10/23,200000,ƒÇn u·ªëng,Expense,1,ƒÇn u·ªëng,categoryDefault0,ff8700,1,,,,,,
2025/10/24,300000,ƒÇn s√°ng ch·ª£ ,Expense,2,Chi ti√™u h√†ng ng√†y,categoryDefault1,00b547,2,,,,,,
2025/10/24,900000,C√°p 13pro max kh√°ch l·∫ª,Income,19,Ti·ªÅn l√†m,category1,ffe666,12,,,,,,
2025/10/24,1000000,C√°p 15pro max ho√†ng ba t√†u,Income,19,Ti·ªÅn l√†m,category1,ffe666,12,,,,,,
2025/10/24,700000,Fix 13pro max ho√†ng ba t√†u,Income,19,Ti·ªÅn l√†m,category1,ffe666,12,,,,,,
2025/10/24,900000,C√°p 14pro max La hi·∫øu,Income,19,Ti·ªÅn l√†m,category1,ffe666,12,,,,,,
2025/10/24,600000,Fix 13pro la hi·∫øu,Income,19,Ti·ªÅn l√†m,category1,ffe666,12,,,,,,
2025/10/25,200000,"Tr√† s·ªØa, ƒÉn s√°ng...",Expense,1,ƒÇn u·ªëng,categoryDefault0,ff8700,1,,,,,,
2025/10/25,200000,C·∫£m xsm l√£i,Income,19,Ti·ªÅn l√†m,category1,ffe666,12,,,,,,
2025/10/25,100000,C·∫£m 11pro l√£i,Income,19,Ti·ªÅn l√†m,category1,ffe666,12,,,,,,
2025/10/25,700000,Fix 13pm la hi·∫øu,Income,19,Ti·ªÅn l√†m,category1,ffe666,12,,,,,,
2025/10/26,70000,ƒÇn s√°ng ,Expense,1,ƒÇn u·ªëng,categoryDefault0,ff8700,1,,,,,,
2025/10/26,200000,Thay l∆∞ng 12pm ,Income,19,Ti·ªÅn l√†m,category1,ffe666,12,,,,,,
2025/10/26,500000,Tr·∫£ quang,Expense,5,Ph√≠ giao l∆∞u,categoryDefault7,ffd500,6,,,,,,
2025/10/26,9900000,ƒê√≥ng ng√¢n h√†ng,Expense,21,Ng√¢n h√†ng,category1,ffe666,21,,,,,,
2025/10/28,100000,Ch·ª£ ƒÉn u·ªëng ,Expense,2,Chi ti√™u h√†ng ng√†y,categoryDefault1,00b547,2,,,,,,
2025/10/28,350000,C·∫£m xsm lai chuy√™n,Income,19,Ti·ªÅn l√†m,category1,ffe666,12,,,,,,
2025/10/28,700000,Fix 13pm ho√†ng ba t√†u,Income,19,Ti·ªÅn l√†m,category1,ffe666,12,,,,,,
2025/10/28,900000,14pro li·ªát main,Income,19,Ti·ªÅn l√†m,category1,ffe666,12,,,,,,
2025/10/28,600000,Ek 12pm l√£i,Income,19,Ti·ªÅn l√†m,category1,ffe666,12,,,,,,
2025/10/28,300000,Pin 12pm l√£i,Income,19,Ti·ªÅn l√†m,category1,ffe666,12,,,,,,
2025/10/29,200000,Ch·ª£ ,Expense,1,ƒÇn u·ªëng,categoryDefault0,ff8700,1,,,,,,
2025/10/29,600000,Thay l∆∞ng 14pm thu v√†o,Income,19,Ti·ªÅn l√†m,category1,ffe666,12,,,,,,
2025/10/29,700000,Fix 13pm ki ,Income,19,Ti·ªÅn l√†m,category1,ffe666,12,,,,,,
2025/10/30,200000,Linh tinh,Expense,2,Chi ti√™u h√†ng ng√†y,categoryDefault1,00b547,2,,,,,,
2025/10/30,450000,K√≠nh 15pm l√£i,Income,19,Ti·ªÅn l√†m,category1,ffe666,12,,,,,,
2025/10/31,80000,ƒÇn s√°ng ,Expense,1,ƒÇn u·ªëng,categoryDefault0,ff8700,1,,,,,,
2025/10/31,300000,Pin 12pm l√£i,Income,19,Ti·ªÅn l√†m,category1,ffe666,12,,,,,,
2025/10/31,90000,C√¥ng m√†n xsm,Income,19,Ti·ªÅn l√†m,category1,ffe666,12,,,,,,
2025/10/31,800000,C√°p 13pm ho√†ng ba t√†u,Income,19,Ti·ªÅn l√†m,category1,ffe666,12,,,,,,
2025/10/31,700000,C√°p 13pm ki ,Income,19,Ti·ªÅn l√†m,category1,ffe666,12,,,,,,
2025/11/1,800000,ƒê√°m c∆∞·ªõi ,Expense,5,Ph√≠ giao l∆∞u,categoryDefault7,ffd500,6,,,,,,
2025/11/1,70000,XƒÉng,Expense,9,ƒêi l·∫°i,categoryDefault4,a9673c,10,,,,,,
2025/11/2,50000,ƒÇn s√°ng ,Expense,1,ƒÇn u·ªëng,categoryDefault0,ff8700,1,,,,,,
2025/11/2,250000,Pin 13 l√£i ,Income,19,Ti·ªÅn l√†m,category1,ffe666,12,,,,,,
2025/11/1,450000,M√†n s20 l√£i,Income,19,Ti·ªÅn l√†m,category1,ffe666,12,,,,,,
,,,Income,17,Thu nh·∫≠p t·∫°m th·ªùi,categoryDefault16,f98bbe,19,,,,,
,,,Expense,7,Gi√°o d·ª•c,categoryDefault5,ff4950,8,,,,,
,,,Expense,8,Ti·ªÅn ƒëi·ªán,categoryDefault8,09ceff,9,,,,,
,,,Expense,3,Qu·∫ßn √°o,categoryDefault2,1638a7,4,,,,,
,,,Income,-2,Kh√¥ng c√≥,categoryNashi,505050,-2,,,,,
,,,Expense,10,Ph√≠ li√™n l·∫°c,categoryDefault9,696969,11,,,,,
,,,Income,14,Ti·ªÅn th∆∞·ªüng,categoryDefault13,ff2e00,15,,,,,
,,,Expense,4,M·ªπ ph·∫©m,categoryDefault3,ff54a8,5,,,,,
,,,Income,13,Ti·ªÅn ph·ª• c·∫•p,categoryDefault12,ffb27f,14,,,,,
</script>

<script>
const fmtMoney = (n) => { try{ return (n||0).toLocaleString('vi-VN'); }catch(e){ return String(n) } };
const pad = (n)=> (n<10?'0':'')+n;
const parseYMD = (s)=>{ if(!s) return null; const p = s.trim().split('/'); if(p.length<3) return null; const y = +p[0], m = +p[1]-1, d = +p[2]; const dt = new Date(y, m, d); return isNaN(dt.getTime())?null:dt; };
const toDateInput = (dt)=> dt? dt.getFullYear() + '-' + pad(dt.getMonth()+1) + '-' + pad(dt.getDate()) : '';
const fromDateInput = (s)=>{ if(!s) return null; const p=s.split('-'); if(p.length<3) return null; return new Date(+p[0], +p[1]-1, +p[2]); };
const inRange = (d, a, b)=>{ if(!d) return false; if(a && d < a) return false; if(b && d > b) return false; return true; };

function parseCSV(text) { 
  const rows = []; let i=0, field='', row=[], inQuotes=false;
  while(i<text.length){
    const c = text[i];
    if(inQuotes){
      if(c==='"'){ if(text[i+1]==='"'){ field+='"'; i++; } else inQuotes=false; }
      else{ field += c; }
    }else{
      if(c==='"'){ inQuotes=true; }
      else if(c===','){ row.push(field); field=''; }
      else if(c==='\n' || c==='\r'){ if(field!=='' || row.length>0){ row.push(field); rows.push(row); row=[]; field=''; } if(c==='\r' && text[i+1]==='\n') i++; }
      else{ field += c; }
    }
    i++;
  }
  if(field!=='' || row.length>0){ row.push(field); rows.push(row); }
  return rows;
}

const RAW0 = parseCSV(document.getElementById('csvData').textContent.trim());
const header0 = RAW0.shift();
const colIndex = (header,name)=> header.findIndex(h => h.trim()===name);

function rowsToObjects(RAW, header){
  const IDX = { 
    date: colIndex(header,'inputDate'),
    amount: colIndex(header,' amount(dong)'),
    memo: colIndex(header,' memo'),
    type: colIndex(header,' type'),
    catName: colIndex(header,' categoryName')
  };
  return RAW.map(r=>{
    const dt = parseYMD(r[IDX.date]);
    const amount = parseFloat(r[IDX.amount]||'0')||0;
    return { 
      dateStr: r[IDX.date]||'',
      date: dt,
      type: (r[IDX.type]||'').trim(),
      category: (r[IDX.catName]||'').trim(),
      memo: (r[IDX.memo]||'').trim(),
      amount,
      src: 'csv'
    };
  }).filter(x=>x.date);
}

let DATA = rowsToObjects(RAW0, header0);

const LS_KEY = 'ttm_money_local_rows_v1';
const localRows = JSON.parse(localStorage.getItem(LS_KEY)||'[]');
localRows.forEach(x=>{ x.date = fromDateInput(x.dateInput); x.dateStr = x.dateInput.replace(/-/g,'/'); x.src='local'; });
DATA = DATA.concat(localRows);

const defaultCats = [
  {name:'ƒÇn u·ªëng', ico:'üçΩÔ∏è'},
  {name:'Chi ti√™u h√†ng ng√†y', ico:'üõçÔ∏è'},
  {name:'Qu·∫ßn √°o', ico:'üëï'},
  {name:'M·ªπ ph·∫©m', ico:'üíÑ'},
  {name:'Ph√≠ giao l∆∞u', ico:'ü•Ç'},
  {name:'Y t·∫ø', ico:'üíä'},
  {name:'Gi√°o d·ª•c', ico:'üìö'},
  {name:'Ti·ªÅn ƒëi·ªán', ico:'üí°'},
  {name:'ƒêi l·∫°i', ico:'üöÜ'},
  {name:'Ph√≠ li√™n l·∫°c', ico:'üì±'},
  {name:'Ti·ªÅn nh√†', ico:'üè†'}
];
function buildCats(){
  const csvCats = Array.from(new Set(DATA.map(x=>x.category).filter(Boolean))).map(n=>({name:n, ico:'üìÅ'}));
  const catDict = {};
  [...defaultCats, ...csvCats].forEach(c=>{ if(!catDict[c.name]) catDict[c.name]=c; });
  return Object.values(catDict);
}
let CATS = buildCats();

const tbody = document.querySelector('#tbl tbody');
const fromDate = document.getElementById('fromDate');
const toDate = document.getElementById('toDate');
const typeSel = document.getElementById('typeSel');
const catSel = document.getElementById('catSel');
const search = document.getElementById('search');
const sumIncome = document.getElementById('sumIncome');
const sumExpense = document.getElementById('sumExpense');
const sumNet = document.getElementById('sumNet');

const tabExpense = document.getElementById('tabExpense');
const tabIncome = document.getElementById('tabIncome');
const inDate = document.getElementById('inDate');
const inMemo = document.getElementById('inMemo');
const inAmount = document.getElementById('inAmount');
const btnAdd = document.getElementById('btnAdd');
const amountLabel = document.getElementById('amountLabel');
const catGrid = document.getElementById('catGrid');

let currentType = 'Expense';
let selectedCat = CATS[0]?.name || '';

function refreshFilterCats(){
  const set = new Set(DATA.map(x=>x.category).filter(Boolean));
  catSel.innerHTML = '<option value="">Danh m·ª•c: T·∫•t c·∫£</option>' + Array.from(set).sort((a,b)=>a.localeCompare(b,'vi')).map(c=>`<option value="${c}">${c}</option>`).join('');
}

function renderCatGrid(){
  catGrid.innerHTML = '';
  CATS.forEach(c=>{
    const div = document.createElement('div');
    div.className = 'cat'+(c.name===selectedCat?' active':'');
    div.innerHTML = `<div class="ico">${c.ico||'üìÅ'}</div><div>${c.name}</div>`;
    div.addEventListener('click', ()=>{ selectedCat=c.name; renderCatGrid(); });
    catGrid.appendChild(div);
  });
  const edit = document.createElement('div');
  edit.className='cat';
  edit.innerHTML = `<div class="ico">‚úèÔ∏è</div><div>Ch·ªânh s·ª≠a</div>`;
  edit.addEventListener('click', ()=>{
    const name = prompt('Th√™m danh m·ª•c m·ªõi:');
    if(name && !CATS.find(x=>x.name===name)){
      CATS.push({name, ico:'üìÅ'});
      selectedCat = name;
      renderCatGrid();
      refreshFilterCats();
    }
  });
  catGrid.appendChild(edit);
}

function applyFilter(){
  const a = fromDate.value ? new Date(fromDate.value+'T00:00:00') : null;
  const b = toDate.value ? new Date(toDate.value+'T23:59:59') : null;
  const t = typeSel.value;
  const q = (search.value||'').toLowerCase().trim();

  let rows = DATA.filter(x=> inRange(x.date, a, b));
  if(t) rows = rows.filter(x=> x.type===t);
  if(catSel.value) rows = rows.filter(x=> x.category===catSel.value);
  if(q) rows = rows.filter(x=> (x.memo+' '+x.category).toLowerCase().includes(q));

  const income = rows.filter(x=>x.type==='Income').reduce((s,x)=>s+x.amount,0);
  const expense = rows.filter(x=>x.type==='Expense').reduce((s,x)=>s+x.amount,0);
  sumIncome.textContent = fmtMoney(income);
  sumExpense.textContent = fmtMoney(expense);
  sumNet.textContent = fmtMoney(income - expense);

  tbody.innerHTML = rows.sort((a,b)=> b.date - a.date).map((x)=>{
    const typePill = x.type==='Income' ? '<span class="type-pill type-income">Thu</span>' : '<span class="type-pill type-expense">Chi</span>';
    const canEdit = x.src==='local';
    return `<tr>
      <td>${x.dateStr}</td>
      <td>${typePill}</td>
      <td>${x.category||''}</td>
      <td>${(x.memo||'').replace(/</g,'&lt;')}</td>
      <td style="text-align:right;font-variant-numeric:tabular-nums">${fmtMoney(x.amount)}</td>
      <td>${canEdit ? '<div class="row-actions"><button data-act="edit" data-id="'+(x._id||'')+'">S·ª≠a</button><button class="danger" data-act="del" data-id="'+(x._id||'')+'">X√≥a</button></div>' : ''}</td>
    </tr>`;
  }).join('');

  tbody.querySelectorAll('button[data-act]').forEach(b=>{
    b.addEventListener('click', ()=>{
      const id = b.getAttribute('data-id');
      if(b.getAttribute('data-act')==='del'){
        const ok = confirm('X√≥a kho·∫£n n√†y?');
        if(!ok) return;
        const arr = JSON.parse(localStorage.getItem(LS_KEY)||'[]').filter(r=> r._id!==id);
        localStorage.setItem(LS_KEY, JSON.stringify(arr));
        DATA = DATA.filter(r=> r._id!==id);
        applyFilter();
      }else if(b.getAttribute('data-act')==='edit'){
        const arr = JSON.parse(localStorage.getItem(LS_KEY)||'[]');
        const idx = arr.findIndex(r=> r._id===id);
        if(idx<0) return;
        const r = arr[idx];
        const memo = prompt('Ghi ch√∫:', r.memo||'');
        if(memo===null) return;
        const amount = parseFloat(prompt('S·ªë ti·ªÅn:', r.amount)||r.amount)||0;
        arr[idx].memo = memo; arr[idx].amount = amount;
        localStorage.setItem(LS_KEY, JSON.stringify(arr));
        const dIdx = DATA.findIndex(x=>x._id===id);
        if(dIdx>=0){ DATA[dIdx].memo=memo; DATA[dIdx].amount=amount; }
        applyFilter();
      }
    });
  });
}

function setQuick(range){
  const now = new Date();
  const today = new Date(now.getFullYear(), now.getMonth(), now.getDate());
  if(range==='today'){
    fromDate.value = toDate.value = toDateInput(today);
  }else if(range==='week'){
    const first = new Date(today); first.setDate(first.getDate() - ((first.getDay()+6)%7));
    const last = new Date(first); last.setDate(first.getDate()+6);
    fromDate.value = toDateInput(first); toDate.value = toDateInput(last);
  }else if(range==='month'){
    const first = new Date(today.getFullYear(), today.getMonth(), 1);
    const last = new Date(today.getFullYear(), today.getMonth()+1, 0);
    fromDate.value = toDateInput(first); toDate.value = toDateInput(last);
  }else if(range==='year'){
    const first = new Date(today.getFullYear(), 0, 1);
    const last = new Date(today.getFullYear(), 11, 31);
    fromDate.value = toDateInput(first); toDate.value = toDateInput(last);
  }else if(range==='all'){
    const dates = DATA.map(x=>x.date).sort((a,b)=>a-b);
    if(dates.length){ fromDate.value = toDateInput(dates[0]); toDate.value = toDateInput(dates[dates.length-1]); }
    else{ fromDate.value=''; toDate.value=''; }
  }
  applyFilter();
}

function exportCSV(){
  const a = fromDate.value ? new Date(fromDate.value+'T00:00:00') : null;
  const b = toDate.value ? new Date(toDate.value+'T23:59:59') : null;
  const t = typeSel.value;
  const q = (search.value||'').toLowerCase().trim();
  let rows = DATA.filter(x=> inRange(x.date, a, b));
  if(t) rows = rows.filter(x=> x.type===t);
  if(catSel.value) rows = rows.filter(x=> x.category===catSel.value);
  if(q) rows = rows.filter(x=> (x.memo+' '+x.category).toLowerCase().includes(q));

  const header = ['inputDate',' amount(dong)',' memo',' type',' categoryName'];
  const body = rows.map(r=>[r.dateStr, r.amount, r.memo, r.type, r.category]);
  const esc = (v)=> { const s = String(v==null?'':v); return /[",\n]/.test(s) ? '"'+s.replace(/"/g,'""')+'"' : s; };
  const csv = [header.join(','), ...body.map(r=>r.map(esc).join(','))].join('\n');
  const blob = new Blob([csv], {type:'text/csv;charset=utf-8;'});
  const url = URL.createObjectURL(blob);
  const aEl = document.createElement('a');
  aEl.href = url; aEl.download = 'so_thu_chi_loc.csv';
  document.body.appendChild(aEl);
  aEl.click();
  URL.revokeObjectURL(url);
  aEl.remove();
}

function setMobileClass(){ document.body.classList.toggle('mobile', window.innerWidth < 768); }

function setType(t){
  currentType = t;
  tabExpense.classList.toggle('active', t==='Expense');
  tabIncome.classList.toggle('active', t==='Income');
  amountLabel.textContent = (t==='Expense' ? 'Ti·ªÅn chi' : 'Ti·ªÅn thu');
  btnAdd.textContent = (t==='Expense' ? 'Nh·∫≠p kho·∫£n chi' : 'Nh·∫≠p kho·∫£n thu');
}

tabExpense.addEventListener('click', ()=> setType('Expense'));
tabIncome.addEventListener('click', ()=> setType('Income'));

function addRecord(){
  const dateInput = inDate.value || toDateInput(new Date());
  const memo = (inMemo.value||'').trim();
  const amount = Math.abs(parseFloat(inAmount.value||'0')||0);
  if(!amount){ alert('Vui l√≤ng nh·∫≠p s·ªë ti·ªÅn > 0'); return; }
  const cat = selectedCat || '';

  const rec = {
    _id: 'L'+Date.now()+Math.random().toString(36).slice(2,6),
    dateInput,
    dateStr: dateInput.replace(/-/g,'/'),
    type: currentType,
    category: cat,
    memo,
    amount,
    src: 'local'
  };
  const arr = JSON.parse(localStorage.getItem(LS_KEY)||'[]');
  arr.push(rec);
  localStorage.setItem(LS_KEY, JSON.stringify(arr));

  const d = {...rec, date: fromDateInput(rec.dateInput)};
  DATA.push(d);

  selectedCat && !CATS.find(c=>c.name===selectedCat) && CATS.push({name:selectedCat, ico:'üìÅ'});
  refreshFilterCats();
  inAmount.value='';
  inMemo.value='';
  applyFilter();
  window.scrollTo({top:0, behavior:'smooth'});
}

btnAdd.addEventListener('click', addRecord);

document.querySelectorAll('.quick button').forEach(b=> b.addEventListener('click', ()=> setQuick(b.dataset.q)));
[fromDate, toDate, typeSel, catSel, search].forEach(el=> el.addEventListener('input', applyFilter));
document.getElementById('btnExport').addEventListener('click', exportCSV);
window.addEventListener('resize', setMobileClass);

// Import CSV
const btnImport = document.getElementById('btnImport');
const fileCSV = document.getElementById('fileCSV');
btnImport.addEventListener('click', ()=> fileCSV.click());
fileCSV.addEventListener('change', async (e)=>{
  const file = e.target.files && e.target.files[0];
  if(!file) return;
  const text = await file.text();
  const RAW = parseCSV(text.trim());
  if(RAW.length<2){ alert('CSV kh√¥ng h·ª£p l·ªá ho·∫∑c r·ªóng.'); return; }
  const header = RAW.shift();
  const names = header.map(h=>h.trim());
  const required = ['inputDate',' amount(dong)',' memo',' type',' categoryName'];
  const ok = required.every(n=> names.includes(n));
  if(!ok){
    alert('CSV kh√¥ng ƒë√∫ng ƒë·ªãnh d·∫°ng y√™u c·∫ßu. C·∫ßn c√°c c·ªôt: '+required.join(', '));
    return;
  }
  const imported = rowsToObjects(RAW, header);
  const mode = confirm('OK = Thay th·∫ø d·ªØ li·ªáu g·ªëc b·∫±ng CSV m·ªõi (gi·ªØ kho·∫£n local).\nCancel = G·ªôp th√™m CSV v√†o d·ªØ li·ªáu hi·ªán t·∫°i.');
  if(mode){
    const locals = DATA.filter(x=>x.src==='local');
    DATA = imported.concat(locals);
  }else{
    DATA = DATA.concat(imported);
  }
  CATS = buildCats();
  refreshFilterCats();
  renderCatGrid();
  setQuick('month');
  e.target.value = '';
});

setMobileClass();
(function initInputs(){
  const today = new Date();
  document.getElementById('inDate').value = toDateInput(today);
  refreshFilterCats();
  renderCatGrid();
  setType('Expense');
  setQuick('month');
})();
</script>
</body>
</html>
